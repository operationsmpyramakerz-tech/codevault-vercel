<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Damaged Assets</title>
  <link rel="stylesheet" href="/style.css"/>
</head>
<body>

  <!-- نفس هيكل الصفحات القياسية (sidebar من common-ui) -->
  <div class="dashboard">
    <aside id="sidebar"></aside>

    <main class="content">
      <div class="content-inner">
        <h1 class="page-title">Damaged Assets</h1>

        <!-- بطاقة المحتوى بنفس ستايل باقي الصفحات -->
        <section class="card">

          <!-- ====== نموذج الصفحة كما هو (بدون حذف أي منطق) ====== -->
          <!-- Header + زر add -->
          <div class="components-header" style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
            <h2 style="margin:0;display:flex;align-items:center;gap:8px">
              <i data-feather="clipboard"></i> Damage Report
            </h2>
            <button type="button" id="addComponentBtn" class="btn btn-outline">
              <i data-feather="plus"></i> Add Component
            </button>
          </div>

          <!-- نموذج V2 (متعدد المكونات) -->
          <form id="damagedFormV2">
            <div id="componentsList"><!-- يتم حقن المكوّنات ديناميكياً من damaged-assets.js --></div>

            <div class="actions" style="display:flex;gap:10px;margin-top:12px">
              <button class="btn btn-primary" id="submitBtnV2" type="submit">
                <i data-feather="save"></i> Submit Report
              </button>
              <button class="btn btn-outline" type="reset" id="clearV2">
                <i data-feather="x-circle"></i> Clear Form
              </button>
            </div>

            <div id="msgV2" class="note" aria-live="polite" style="margin-top:8px"></div>
          </form>

          <!-- احتفاظ بالنموذج القديم كما هو (لو كان موجود) بدون أي حذف -->
          <form id="damageForm" style="display:none">
            <!-- legacy form kept intact intentionally -->
          </form>
          <!-- ====== /نهاية نموذج الصفحة ====== -->

        </section>
      </div>
    </main>
  </div>

  <!-- Feather icons -->
  <script src="https://unpkg.com/feather-icons"></script>
  <script>feather.replace();</script>

  <!-- سكربتات النظام -->
  <script src="/common-ui.js"></script>
  <script src="/damaged-assets.js"></script>

  <!-- تفعيل وبناء السايدبار من common-ui بنفس منطق Allowed Pages -->
  <script>
    (function () {
      var ACTIVE = "Damaged Assets";
      var mount = document.getElementById("sidebar");

      // نستخدم دوالكم كما هي إن كانت متوفرة
      if (window.UI) {
        if (typeof UI.mountSidebar === "function") {
          UI.mountSidebar(mount, ACTIVE);
        } else if (typeof UI.renderSidebar === "function") {
          UI.renderSidebar({ mount, active: ACTIVE });
        } else if (typeof UI.initSidebar === "function") {
          UI.initSidebar(ACTIVE);
        } else if (typeof UI.buildSidebar === "function") {
          UI.buildSidebar({ el: mount, active: ACTIVE });
        } else {
          // fallback بسيط إن لزم الأمر (لن يظهر لو common-ui يوفّر الدوال)
          mount.innerHTML = '<div class="sidebar"><div class="sidebar-header">Dashboard</div></div>';
        }
      }
    })();
  </script>

</body>
</html>
